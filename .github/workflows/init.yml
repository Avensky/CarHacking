# This file is a manually triggered clean installation

name: Initial install

on:
  workflow_dispatch:

jobs:
  backend:
    runs-on: self-hosted
    steps:
      - name: Checkout to the repository
        uses: actions/checkout@v4
      - name: Set up NodeJS environment
        uses: actions/setup-node@v4
        with:
          node-version: 18.20.3 
      - name: Install Dependencies
        run: |
          cd backend
          npm i
      - name: Check linting and formatting
        run: |
          cd backend
          npm run lint
      - name: Execute test cases
        run: echo testing...
  frontend:
    needs: backend
    runs-on: self-hosted
    steps:
      - name: Checkout to the repository
        uses: actions/checkout@v4
      - name: Set up NodeJS environment
        uses: actions/setup-node@v4
        with:
          node-version: 18 
      - name: Install Dependencies
        run: |
          cd frontend
          npm i
      - name: Check linting and formatting
        run: |
          cd frontend
          npm run lint
  build:
    needs: frontend
    runs-on: self-hosted
    steps:
      - name: Checkout to the repository
        uses: actions/checkout@v4
      - name: Set up NodeJS environment
        uses: actions/setup-node@v4
        with:
          node-version: 18.20.3 
      - name: Install Dependencies
        run: |
          cd backend
          npm i
          cd ../frontend
          npm i
      - name: Create production build
        run: |
          cd frontend
          npm run build